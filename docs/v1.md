Below is a single, coherent V1 spec you can treat as ‚Äúthis is what we‚Äôre building‚Äù. It is written to match your current stack (Firebase + Cloud Functions + React) and your reality (solo builder, North Cyprus, Chat + Connect only).

‚∏ª

Easy Islanders ‚Äì V1 Product & System Specification

1. V1 Product Definition

1.1. One-line

Easy Islanders V1 is a North Cyprus Life OS for students and expats that lets them:
	‚Ä¢	talk to an agent to get help with anything,
	‚Ä¢	discover people, places, and activities on a live map,
	‚Ä¢	book taxis and basic services,
	‚Ä¢	request housing and car rentals,
	‚Ä¢	and submit open-ended ‚ÄúRequests‚Äù for anything you don‚Äôt have structured supply for yet.

1.2. Surfaces in V1

User-facing:
	1.	Chat (Home)
	‚Ä¢	Main interface: ‚ÄúI need X‚Äù ‚Üí the agent handles it with tools + fallback to Requests.
	2.	Connect (Map)
	‚Ä¢	Map of People ¬∑ Places ¬∑ Activities with filters, markers, and actions.
	3.	Profile (very simple)
	‚Ä¢	See/update name, phone, city, role.

Admin/internal (only you for now):
	4.	Catalog Console (admin-only)
	‚Ä¢	Manage Places, Activities, Listings (Real Estate, Cars), Service Providers.
	5.	Requests Console (admin-only)
	‚Ä¢	View and process all user Requests.

No public Explore page in the main nav for V1. Explore‚Äôs listing/search logic is reused inside Chat.

1.3. Roles
	‚Ä¢	End User: student/expat/tourist using app.
	‚Ä¢	Admin: you (and later ops team) with full access to Catalog + Requests consoles.
	‚Ä¢	(No direct business/partner login in V1.)

‚∏ª

2. Core Domains & Data Models

All collections are Firestore collections.

2.1. City

You will start with 1 city (North Cyprus), but design is multi-city.

/cities/{cityId} {
  id: string;                   // 'north-cyprus'
  name: string;                 // 'North Cyprus'
  country: string;              // 'Cyprus'
  center: { lat: number; lng: number };
  bounds?: { ... };             // optional map bounds
  timezone: string;             // 'Asia/Nicosia'
  active: boolean;
}

2.2. User & Profile (‚ÄúPeople‚Äù)

User auth is via Firebase Auth. Extra profile info stored separately.

/users/{userId} {
  displayName: string;
  email?: string;
  phone?: string;
  photoURL?: string;
  createdAt: Timestamp;
  role: 'user' | 'admin';
}

/userProfiles/{userId} {
  cityId: string;                     // 'north-cyprus'
  userType: 'student' | 'expat' | 'visitor' | 'other';
  university?: string;
  language?: string;
  interests?: string[];               // ['nightlife', 'beach', ...]
  // Presence
  currentLocation?: {
    placeId?: string;
    lat?: number;
    lng?: number;
    updatedAt: Timestamp;
  };
  // Optional preferences (for future intelligence)
  preferences?: {
    nightlifeLevel?: 'low' | 'medium' | 'high';
    budgetLevel?: 'low' | 'medium' | 'high';
  };
}

Optional light ‚Äúconnection‚Äù model:

/connectionRequests/{id} {
  fromUserId: string;
  toUserId: string;
  status: 'pending' | 'accepted' | 'rejected';
  createdAt: Timestamp;
}

/connections/{id} {
  userAId: string;
  userBId: string;
  createdAt: Timestamp;
  source: 'wave';
}

2.3. Places

Venues and points of interest: restaurants, bars, cafes, sights, services, etc.

/places/{placeId} {
  cityId: string;                     // 'north-cyprus'
  name: string;
  category: 'food' | 'nightlife' | 'sight' | 'service' | 'shop' | 'other';
  subcategory?: string;               // 'cafe', 'bar', 'beach_club', etc.

  coordinates: { lat: number; lng: number };
  address?: string;
  areaName?: string;                  // 'Kyrenia', 'Famagusta', etc.

  description?: string;
  images?: string[];
  tags?: string[];                    // ['students', 'sunset', 'hookah']

  // Contact
  phone?: string;
  whatsapp?: string;
  website?: string;
  instagram?: string;

  // Actions supported at this place
  actions: {
    taxiEnabled: boolean;            // always true realistically
    reservationsEnabled: boolean;    // if they accept table bookings
    activityBookingEnabled: boolean; // if they host bookable events
    serviceTypes?: string[];         // e.g. ['water', 'gas'] if supply hub
  };

  // Reservation config
  reservationConfig?: {
    bookingType: 'none' | 'whatsapp' | 'link' | 'internal';
    bookingTarget?: string;          // WA number / URL / internal partnerId
  };

  // Operational
  isActive: boolean;
  createdAt: Timestamp;
  createdBy: string;                 // admin userId
}

2.4. Activities (Events / Things happening)

Activities are time-bound events anchored to a place or coordinates.

/activities/{activityId} {
  cityId: string;

  title: string;
  description?: string;
  category: 'nightlife' | 'social' | 'sport' | 'culture' | 'food' | 'other';

  placeId?: string;                   // either placeId or direct coordinates
  coordinates: { lat: number; lng: number };

  startsAt: Timestamp;
  endsAt?: Timestamp;

  price?: number;
  currency?: string;
  isFree: boolean;

  hostUserId?: string;                // creator
  hostName?: string;
  hostContactWhatsApp?: string;

  bookingType: 'none' | 'whatsapp' | 'link' | 'internal';
  bookingTarget?: string;             // WA number / URL / partnerId

  status: 'pending' | 'approved' | 'rejected';

  createdAt: Timestamp;
  createdBy: string;                  // userId
}

V1 rule:
	‚Ä¢	Only status: 'approved' activities appear on the public map.
	‚Ä¢	Users can submit activities; admin approves through Catalog Console.

2.5. Listings (Real Estate, Cars)

Use a generic Listing model with a kind discriminator.

/listings/{listingId} {
  cityId: string;
  kind: 'housing' | 'car_rental';     // we can extend later

  title: string;
  description?: string;
  images?: string[];

  // Common fields
  price: number;
  currency: string;
  priceUnit: 'per_month' | 'per_night' | 'per_day' | 'total';
  tags?: string[];

  // Housing-specific
  housing?: {
    type: 'apartment' | 'villa' | 'room' | 'studio';
    bedrooms: number;
    bathrooms?: number;
    furnished?: boolean;
    areaName?: string;
    nearPlaceId?: string;
    developerId?: string;            // link to partner
    agentId?: string;                // link to partner
    minStayMonths?: number;
  };

  // Car rental-specific
  carRental?: {
    providerId?: string;             // /serviceProviders/{id}
    carType: 'small' | 'sedan' | 'SUV' | 'van' | 'other';
    transmission?: 'manual' | 'automatic';
    seats?: number;
    mileageLimitPerDay?: number;
  };

  // Partner & booking
  bookingType: 'whatsapp' | 'link' | 'internal';
  bookingTarget: string;             // WA number / URL / internal partnerId

  isActive: boolean;
  createdAt: Timestamp;
  createdBy: string;                 // admin userId
}

2.6. Service Providers / Partners

Optional but useful to structure who actually fulfills stuff.

/serviceProviders/{partnerId} {
  cityId: string;
  name: string;

  type: 'taxi' | 'housing_agent' | 'developer' | 'car_rental' | 'water_gas' | 'other';

  contact: {
    phone?: string;
    whatsapp?: string;
    email?: string;
  };

  // For routing
  serviceCategories?: string[];      // ['HOUSING', 'CAR_RENTAL', 'WATER_GAS']
  areaNames?: string[];              // e.g. ['Kyrenia', 'Alsancak']

  notes?: string;
  isActive: boolean;
  createdAt: Timestamp;
}

2.7. Requests (Catch-all + structured demand)

A generic Request capturing any user ask that needs manual follow-up.

/requests/{requestId} {
  userId: string;
  cityId: string;

  category:
    | 'TAXI'
    | 'HOUSING'
    | 'CAR_RENTAL'
    | 'WATER_GAS'
    | 'GROCERIES'
    | 'ACTIVITY'
    | 'OTHER';

  title: string;                    // human-readable summary
  description: string;              // free text from user / agent

  // structured fields
  meta?: {
    // Time
    when?: 'now' | 'today' | 'this_weekend' | 'date_range';
    fromDate?: Timestamp;
    toDate?: Timestamp;

    // Location
    placeId?: string;
    lat?: number;
    lng?: number;
    areaName?: string;

    // Housing-specific
    beds?: number;
    intent?: 'rent' | 'buy';
    budgetMin?: number;
    budgetMax?: number;

    // Car-specific
    carType?: string;
    rentalDays?: number;

    // Generic
    quantity?: number;
    notes?: string;
  };

  status: 'new' | 'in_progress' | 'resolved' | 'cancelled';

  createdAt: Timestamp;
  updatedAt: Timestamp;

  // Contact fallback (if not using profile)
  contactPhone?: string;
  contactWhatsApp?: string;
  preferredContact?: 'whatsapp' | 'phone' | 'in_app';

  // Internal routing
  assignedPartnerId?: string;       // /serviceProviders/{id}
  internalNotes?: string;
}

In V1, Requests are the main ‚Äújob‚Äù object. Taxi/housing/car requests always create a Request entry, even if there‚Äôs extra taxi-specific data in another collection.

2.8. Events / Analytics (optional but recommended)

/events/{eventId} {
  cityId: string;
  userId?: string;
  type:
    | 'CHAT_MESSAGE'
    | 'REQUEST_CREATED'
    | 'PLACE_VIEWED'
    | 'ACTIVITY_VIEWED'
    | 'MAP_TAP_PLACE'
    | 'MAP_TAP_ACTIVITY';

  objectType?: 'place' | 'activity' | 'request';
  objectId?: string;

  metadata?: any;
  createdAt: Timestamp;
}


‚∏ª

3. Chat ‚Äì V1 Behaviour Specification

Chat is the primary interaction surface.

3.1. UI Elements
	‚Ä¢	Chat thread (messages from user, agent, system).
	‚Ä¢	Quick action chips above input:
	‚Ä¢	Find housing
	‚Ä¢	Book a taxi
	‚Ä¢	Order water/gas
	‚Ä¢	Rent a car
	‚Ä¢	Plan my weekend
	‚Ä¢	Request a service (generic)
	‚Ä¢	Optional right panel / bottom section for:
	‚Ä¢	‚ÄúMy requests‚Äù (list of current Requests and statuses).

3.2. Agent Capabilities
	1.	Local Q&A
	‚Ä¢	Answer general questions about areas, visas, utilities, safety, etc.
	‚Ä¢	May reference static content or just LLM knowledge + your city hints.
	2.	Taxi
	‚Ä¢	User says: ‚ÄúSend a taxi to [place] from [place]‚Äù or uses quick action.
	‚Ä¢	Agent:
	‚Ä¢	resolves origin/destination using map/place info or user location.
	‚Ä¢	calls a createTaxiRequest tool (internally creates /requests doc with category TAXI and taxi-specific meta, and optionally also in taxiBookings collection).
	‚Ä¢	Backend sends WhatsApp to taxi group/partner with details.
	‚Ä¢	Chat displays:
	‚Ä¢	‚ÄúI‚Äôve created a taxi request from [A] to [B]. You‚Äôll receive confirmation on WhatsApp.‚Äù
	3.	Water / Gas / Groceries
	‚Ä¢	Similar flow:
	‚Ä¢	createServiceRequest with category = 'WATER_GAS' or 'GROCERIES'.
	‚Ä¢	Chat confirms and indicates follow-up channel.
	4.	Housing
	‚Ä¢	User asks: ‚ÄúI need a 1-bedroom near GAU for up to ‚Ç¨600/month.‚Äù
	‚Ä¢	Agent:
	‚Ä¢	extracts structured params (beds, budget, area, move-in).
	‚Ä¢	calls searchHousingListings (backed by your Typesense/Explore logic).
	‚Ä¢	calls createHousingRequest tool ‚Üí creates /requests with category = 'HOUSING' and filled meta.
	‚Ä¢	Chat:
	‚Ä¢	shows 2‚Äì5 listing cards (title, price, photo, ‚ÄúChat about this listing‚Äù CTA).
	‚Ä¢	confirms the request was logged for agent follow-up.
	5.	Car Rentals
	‚Ä¢	Similar to housing:
	‚Ä¢	searchCarRentalListings,
	‚Ä¢	createCarRentalRequest (category CAR_RENTAL).
	‚Ä¢	Chat shows options and logs a Request.
	6.	Places Discovery
	‚Ä¢	User: ‚ÄúWhere should I go tonight?‚Äù / ‚ÄúBrunch near Kyrenia?‚Äù
	‚Ä¢	Agent:
	‚Ä¢	calls searchPlaces with category and area,
	‚Ä¢	returns list of Place cards (name, category, tags, ‚ÄúView on map‚Äù).
	‚Ä¢	Each card has:
	‚Ä¢	‚ÄúView on map‚Äù (navigates to Connect with that place selected).
	‚Ä¢	Optional ‚ÄúTaxi here‚Äù.
	7.	Weekend Planning
	‚Ä¢	Agent calls:
	‚Ä¢	searchPlaces for different categories,
	‚Ä¢	searchActivities for the weekend.
	‚Ä¢	Returns:
	‚Ä¢	a textual plan + inline place/activity cards with ‚ÄúView on map‚Äù actions.
	8.	Fallback Requests (catch-all)
	‚Ä¢	If agent cannot fulfill from existing data (e.g. ‚ÄúI need a photographer‚Äù, ‚ÄúI need a plumber‚Äù):
	‚Ä¢	agent proposes: ‚ÄúI can log a request and we‚Äôll contact you with options.‚Äù
	‚Ä¢	on user consent ‚Üí createServiceRequest with category = 'OTHER'.
	‚Ä¢	Chat confirms and user knows they will be contacted.

3.3. ‚ÄúMy Requests‚Äù (optional but useful in V1)
	‚Ä¢	A small panel in Chat that lists:
	‚Ä¢	/requests where userId == currentUser, sorted by createdAt desc.
	‚Ä¢	Show:
	‚Ä¢	category,
	‚Ä¢	title,
	‚Ä¢	status,
	‚Ä¢	createdAt.

‚∏ª

4. Connect ‚Äì People ¬∑ Places ¬∑ Activities Map

Connect is the visual ‚Äúcity cockpit‚Äù.

4.1. Filters & Layers

Top filter bar:
	‚Ä¢	All
	‚Ä¢	Food
	‚Ä¢	Nightlife
	‚Ä¢	Sights
	‚Ä¢	Activities

Layers:
	‚Ä¢	Places: always loaded; filtered by category.
	‚Ä¢	Activities: loaded and shown when filter is All or Activities.
	‚Ä¢	People: optional; show users with currentLocation set and recent activity.

4.2. Place Interactions

On map:
	‚Ä¢	Pins colored by category.
	‚Ä¢	When user taps a place:

Card shows:
	‚Ä¢	Photo, name, category.
	‚Ä¢	Short description, areaName.
	‚Ä¢	Opening hours (optional later).
	‚Ä¢	Actions:

	1.	Taxi here
	‚Ä¢	Calls createTaxiRequest with destination = this Place.
	‚Ä¢	Chat or toast confirms.
	2.	WhatsApp (if whatsapp set)
	‚Ä¢	wa.me link with a templated message:
	‚Ä¢	‚ÄúHi, I‚Äôm contacting you via Easy Islanders about [PlaceName].‚Äù
	3.	Call (if phone set)
	‚Ä¢	tel: link.
	4.	Directions
	‚Ä¢	Opens Google/Apple Maps with lat/lng.
	5.	Request something here (link)
	‚Ä¢	Opens short Request form prefilled with meta.placeId & areaName.
	‚Ä¢	On submit ‚Üí creates Request with category = 'OTHER' and description.

4.3. Activity Interactions

Activity markers (e.g. small dot/star icons).

Tap activity:

Card shows:
	‚Ä¢	Title, category, time range.
	‚Ä¢	Place name (tap ‚Üí highlight place).
	‚Ä¢	Price (or ‚ÄúFree‚Äù).
	‚Ä¢	Host name.

Actions:
	1.	Book / Join
	‚Ä¢	If bookingType == 'whatsapp':
	‚Ä¢	open WA to bookingTarget with message:
	‚Ä¢	‚ÄúHi, I want to join [ActivityTitle] on [date] via Easy Islanders.‚Äù
	‚Ä¢	If bookingType == 'link':
	‚Ä¢	open link in new tab.
	‚Ä¢	If bookingType == 'internal' (optional later):
	‚Ä¢	create a Request with category = 'ACTIVITY' and meta.activityId.
	2.	Taxi there
	‚Ä¢	same as place: create taxi Request with destination coordinates.
	3.	Share (optional)
	‚Ä¢	copy shareable link or open OS share sheet.

4.4. People Interactions (light V1)

People markers:
	‚Ä¢	Only show users who have opted in / checked in recently.
	‚Ä¢	Represent as avatars or initials.

Tap:
	‚Ä¢	Shows:
	‚Ä¢	name, userType, maybe one interest.
	‚Ä¢	Actions:
	‚Ä¢	üëã Wave
	‚Ä¢	creates connectionRequest.
	‚Ä¢	(If they already waved at you)
	‚Ä¢	Wave back & connect ‚Üí creates connection doc.
	‚Ä¢	(Full chat/DM is v2; you can delay until you‚Äôre comfortable.)

‚∏ª

5. Catalog & Content Management (Admin)

Since there is no business dashboard in V1, you as Admin need a place to add/manage content.

5.1. Catalog Console (Admin-only UI)

Tabs:
	1.	Places
	‚Ä¢	List of /places, filter by category and area.
	‚Ä¢	‚ÄúAdd place‚Äù form:
	‚Ä¢	name, category, coordinates (select on map), description, address, contact info, actions, reservation config, tags.
	‚Ä¢	Edit existing places.
	2.	Activities
	‚Ä¢	List of /activities, filter by status.
	‚Ä¢	Approve/reject newly submitted activities (created by users).
	‚Ä¢	‚ÄúCreate activity‚Äù form (for admin to seed bigger events).
	3.	Listings
	‚Ä¢	List of /listings with filter kind = housing or car_rental.
	‚Ä¢	‚ÄúAdd listing‚Äù:
	‚Ä¢	For housing: type, beds, area, price, partner, bookingType.
	‚Ä¢	For car rentals: provider, carType, price, bookingType.
	4.	Service Providers
	‚Ä¢	Manage /serviceProviders:
	‚Ä¢	taxi partners, agents, developers, car rentals, water/gas vendors.

Internally, you can seed everything manually from here.

5.2. User-submitted Activities

On Connect (for logged-in users):
	‚Ä¢	Small button: + Add activity (or a separate ‚ÄúCreate Activity‚Äù page).
	‚Ä¢	Simplified form:
	‚Ä¢	title, description, date/time, category, place (choose from Places or drop pin), host name, host WA.
	‚Ä¢	On submit:
	‚Ä¢	Create /activities with status = 'pending'.
	‚Ä¢	In Catalog Console:
	‚Ä¢	Admin sees pending activities and can approve or reject.
	‚Ä¢	Approved activities appear on the map.

‚∏ª

6. Requests Console (Admin)

Your main ops tool in V1.

6.1. List view

Table of /requests:
	‚Ä¢	Columns:
	‚Ä¢	createdAt,
	‚Ä¢	category,
	‚Ä¢	title,
	‚Ä¢	userName,
	‚Ä¢	status.
	‚Ä¢	Filters:
	‚Ä¢	by status (new, in_progress, resolved),
	‚Ä¢	by category.

6.2. Detail view

When clicking a Request:
	‚Ä¢	Show:
	‚Ä¢	user info (+ ‚ÄúOpen in WhatsApp/phone‚Äù),
	‚Ä¢	full description,
	‚Ä¢	meta (time, location, budget, etc),
	‚Ä¢	contact details,
	‚Ä¢	assignedPartnerId (if any).
	‚Ä¢	Actions:
	‚Ä¢	Mark in progress,
	‚Ä¢	Mark resolved,
	‚Ä¢	Assign to partner (drop-down from /serviceProviders),
	‚Ä¢	Add internal notes.

Workflow:
	‚Ä¢	When new request comes in:
	‚Ä¢	you see it in status = 'new'.
	‚Ä¢	decide:
	‚Ä¢	contact partner via WA / phone,
	‚Ä¢	update status along the way.
	‚Ä¢	No need to notify user in-app in v1 beyond WhatsApp and initial Chat confirmation.

‚∏ª

7. Business/Service Upload Flows in V1

You, as admin, upload:
	‚Ä¢	Places: venues + service hubs.
	‚Ä¢	Real Estate Listings: from agents/developers.
	‚Ä¢	Car Rental Listings: from car partners.
	‚Ä¢	Activities: big events + approve user-generated ones.

Sources:
	‚Ä¢	Direct contact with businesses (WhatsApp / meetings).
	‚Ä¢	Online data (websites, flyers).

Process:
	‚Ä¢	Take photos, info, deals.
	‚Ä¢	Enter via Catalog Console.
	‚Ä¢	Make sure bookingType and bookingTarget are correct so that ‚ÄúBook/Join‚Äù and ‚ÄúWhatsApp‚Äù actions work.

No external business login in V1. Businesses will send you changes manually, you update.

‚∏ª

8. Summary: V1 Scope Checklist

Surfaces
	‚Ä¢	Chat (Home)
	‚Ä¢	Connect (Map)
	‚Ä¢	Profile (basic)
	‚Ä¢	Catalog Console (admin)
	‚Ä¢	Requests Console (admin)

Data Models
	‚Ä¢	/cities
	‚Ä¢	/users, /userProfiles
	‚Ä¢	/places
	‚Ä¢	/activities
	‚Ä¢	/listings (housing, car_rental)
	‚Ä¢	/serviceProviders
	‚Ä¢	/requests
	‚Ä¢	/connections / /connectionRequests (optional)
	‚Ä¢	/events (optional)

Chat Capabilities
	‚Ä¢	Local Q&A
	‚Ä¢	Taxi request
	‚Ä¢	Water/gas/groceries request
	‚Ä¢	Housing help (with listing cards + housing Request)
	‚Ä¢	Car rental suggestions (with car Request)
	‚Ä¢	Places discovery + ‚ÄúView on map‚Äù
	‚Ä¢	Weekend planning using places/activities
	‚Ä¢	Generic ‚ÄúRequest a service‚Äù flow

Connect Map
	‚Ä¢	Filters: All, Food, Nightlife, Sights, Activities
	‚Ä¢	Place markers ‚Üí card with Taxi here, WhatsApp, Call, Directions, Request something here
	‚Ä¢	Activity markers ‚Üí card with Book/Join (WA/link/internal), Taxi there
	‚Ä¢	Optional people markers + Wave

Admin
	‚Ä¢	Catalog Console for Places / Activities / Listings / ServiceProviders
	‚Ä¢	Activity approval workflow
	‚Ä¢	Requests Console for all /requests (list, detail, assign, status)

This is the full V1 spec. From here, you can implement piece by piece, but you now have a stable destination that matches your vision: Chat + Connect, powered by people/places/activities, with Requests as the safety net for everything you don‚Äôt have structured yet.
Below is a clean, detailed domain model you can treat as the backbone of Easy Islanders. It is structured so you can:
	‚Ä¢	Represent different user types (student, expat, traveller/visitor, local).
	‚Ä¢	Support multi-city from day one.
	‚Ä¢	Plug in Chat, Connect (map), Explore, taxi/water/housing jobs, and future intelligence.

You can map this almost directly into Firestore collections / TypeScript interfaces.

‚∏ª

1. High-level domain map

Core domains:
	1.	Identity & segmentation
	2.	Territory & geography (cities, areas, places, anchors)
	3.	Social / Connect (tribes, posts, check-ins, connections)
	4.	Services & jobs (taxis, water/gas, housing leads, bookings)
	5.	Listings & commerce (housing & stays)
	6.	Partners (agents, developers, drivers, venues)
	7.	Intelligence & analytics (user intelligence, events)
	8.	System & notifications

Everything should be expressed as relations between these domains.

‚∏ª

2. Identity & segmentation

2.1. User

Base auth identity (Firebase Auth):

// Firestore: /users/{userId}
interface User {
  id: string;                 // same as auth.uid
  email?: string;
  phone?: string;
  displayName?: string;
  photoURL?: string;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;

  roles: ('user' | 'admin' | 'partner')[];
  // Optional, if you want fine-grained permissions later
  flags?: {
    betaTester?: boolean;
    blocked?: boolean;
  };
}

2.2. UserProfile (segmentation)

One per user; holds segmentation and context:

// Firestore: /userProfiles/{userId}
type UserType = 'student' | 'expat' | 'traveller' | 'local';

interface UserProfile {
  userId: string;
  userType: UserType;

  // Core location context
  currentCityId: string;        // e.g. 'north-cyprus'
  homeCityId?: string;          // for locals, origin city for expats/travellers

  // Student-specific fields
  universityId?: string;        // FK to /universities
  universityName?: string;      // denormalized for convenience
  campusName?: string;
  faculty?: string;
  program?: string;
  yearOfStudy?: number;         // 1, 2, 3, etc.
  dormName?: string;

  // Expat-specific fields
  originCountry?: string;
  lengthOfStayMonths?: number;
  workMode?: 'remote' | 'on-site' | 'mixed';
  primaryReason?: 'work' | 'retirement' | 'investment' | 'other';

  // Traveller/visitor-specific fields
  stayStartDate?: FirebaseTimestamp;
  stayEndDate?: FirebaseTimestamp;
  travelStyle?: ('budget' | 'midrange' | 'luxury')[];
  interests?: string[];         // 'beach', 'nightlife', 'culture', etc.

  // Local-specific fields
  neighborhoodId?: string;      // FK to /areas
  hasCar?: boolean;

  // General preferences
  preferences?: {
    nightlifeIntensity?: 'low' | 'medium' | 'high';
    noiseTolerance?: 'quiet' | 'normal' | 'vibrant';
    likesCrowds?: boolean;
    maxBudgetHousing?: number;
    preferredAreas?: string[];  // areaIds
  };

  completedOnboarding: boolean;
  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

2.3. Universities / institutions

To avoid hardcoding:

// Firestore: /universities/{universityId}
interface University {
  id: string;
  cityId: string;              // 'north-cyprus'
  name: string;
  shortName?: string;
  campuses: {
    id: string;
    name: string;
    coordinates?: { lat: number; lng: number };
  }[];
}


‚∏ª

3. Territory & geography

This is what your map and routing logic stand on.

3.1. City

// Firestore: /cities/{cityId}
interface City {
  id: string;                  // 'north-cyprus'
  name: string;                // 'North Cyprus'
  country: string;             // 'Cyprus' (or local entity)
  timeZone: string;            // 'Europe/Istanbul' etc.

  // Map bounds
  bounds: {
    north: number;
    south: number;
    east: number;
    west: number;
  };

  // Configuration flags
  isActive: boolean;
  defaultCurrency: string;     // 'USD', 'EUR'
  primaryLanguage: string;     // 'en', etc.
  supportedUserTypes: UserType[];

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

3.2. Areas / Zones (neighborhoods, regions)

You need coarse units for housing, heatmaps, etc.:

// Firestore: /areas/{areaId}
interface Area {
  id: string;
  cityId: string;
  name: string;                 // 'Kyrenia Center'
  type: 'neighborhood' | 'district' | 'campus' | 'region';
  coordinates: { lat: number; lng: number };
  polygon?: GeoJSONPolygon;     // optional, for more exact mapping
  tags?: string[];              // 'student', 'expat', 'nightlife', etc.

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

3.3. Places (venues, businesses, key spots)

This powers Connect map and some agent answers.

// Firestore: /places/{placeId}
type PlaceCategory =
  | 'food'
  | 'nightlife'
  | 'sight'
  | 'cafe'
  | 'co_working'
  | 'shopping'
  | 'service'
  | 'housing_project'
  | 'other';

interface Place {
  id: string;
  cityId: string;
  areaId?: string;                  // optional link to /areas

  name: string;
  category: PlaceCategory;
  coordinates: { lat: number; lng: number };
  address?: string;
  googlePlaceId?: string;           // if synced
  osmId?: string;                   // if used

  descriptionShort?: string;
  descriptionLong?: string;
  tags?: string[];                  // 'students', 'sunset', 'hookah', etc.

  // Contact / booking
  phone?: string;
  whatsapp?: string;
  website?: string;
  instagram?: string;

  bookingType?: 'none' | 'whatsapp' | 'link' | 'internal';
  bookingTarget?: string;           // whatsapp number, reservation URL, or partnerId

  // Meta
  averagePriceLevel?: 1 | 2 | 3 | 4;   // rough affordability
  ratingAverage?: number;
  ratingCount?: number;

  isFeatured?: boolean;
  isActive: boolean;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

3.4. Anchors / Hotspots

For fine-grained ‚ÄúDrop Anchor‚Äù and PulseBar:

// Firestore: /anchors/{anchorId}
interface Anchor {
  id: string;
  cityId: string;
  placeId?: string;                  // anchor inside a place
  areaId?: string;

  name: string;                      // 'Sunset Corner', 'Main Bar Area'
  coordinates: { lat: number; lng: number };
  type: 'hotspot' | 'meeting_point' | 'viewpoint' | 'transit';

  tags?: string[];                   // 'sunset', 'students', 'expats'
  isActive: boolean;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}


‚∏ª

4. Social / Connect domain

This powers tribes, posts, check-ins, connections, and feed.

4.1. Tribes / Groups

// Firestore: /tribes/{tribeId}
type TribeType = 'student' | 'expat' | 'interest' | 'housing' | 'event_based';

interface Tribe {
  id: string;
  cityId: string;
  type: TribeType;

  name: string;                     // 'GAU Freshers 2025'
  description?: string;
  coverImageUrl?: string;

  visibility: 'public' | 'city_public' | 'private';
  ownerId: string;
  adminIds: string[];

  memberCount: number;
  tags?: string[];                  // 'students', 'crypto', 'party', etc.

  defaultAnchorId?: string;         // where they typically meet
  defaultAreaId?: string;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

Membership:

// Firestore: /tribeMembers/{id} OR subcollection /tribes/{tribeId}/members/{userId}
interface TribeMember {
  tribeId: string;
  userId: string;
  role: 'member' | 'admin';
  joinedAt: FirebaseTimestamp;
}

4.2. Posts / Feed

Keep posts simple, strongly tied to place/anchor/time.

// Firestore: /posts/{postId}
type PostType = 'check_in' | 'activity_plan' | 'info' | 'photo';

interface Post {
  id: string;
  cityId: string;
  authorId: string;
  tribeId?: string;

  type: PostType;
  text?: string;
  imageUrls?: string[];

  placeId?: string;
  anchorId?: string;

  startsAt?: FirebaseTimestamp;     // for activity_plan
  endsAt?: FirebaseTimestamp;

  likeCount: number;
  commentCount: number;

  visibility: 'public' | 'tribe';
  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

Comments:

// Firestore: /posts/{postId}/comments/{commentId}
interface Comment {
  id: string;
  postId: string;
  authorId: string;
  text: string;
  createdAt: FirebaseTimestamp;
}

4.3. Check-ins / Passport stamps

You can implement this as either:
	‚Ä¢	special check_in posts, and
	‚Ä¢	separate passportStamps for gamification.

Stamps:

// Firestore: /passportStamps/{stampId}
interface PassportStamp {
  id: string;
  userId: string;
  cityId: string;
  placeId?: string;
  anchorId?: string;
  areaId?: string;

  category: 'food' | 'nightlife' | 'sight' | 'activity' | 'housing_project';
  label: string;                     // 'North Coast Explorer', 'Old Town Regular'

  awardedAt: FirebaseTimestamp;
  source: 'check_in' | 'activity' | 'system';
}

4.4. Connections (people network)

For ‚Äúwave ‚Üí wave back ‚Üí connection‚Äù:

// Firestore: /connections/{connectionId}
interface Connection {
  id: string;
  userAId: string;
  userBId: string;
  createdAt: FirebaseTimestamp;
  source: 'wave' | 'housing_match' | 'tribe';
}

Pending waves:

// Firestore: /connectionRequests/{requestId}
interface ConnectionRequest {
  id: string;
  fromUserId: string;
  toUserId: string;
  status: 'pending' | 'accepted' | 'rejected';
  createdAt: FirebaseTimestamp;
  respondedAt?: FirebaseTimestamp;
}


‚∏ª

5. Services & jobs

This is your operational backbone: taxis, water/gas, housing requests, table bookings later.

5.1. Job (generic, for v2+ spine)

Even if v1 uses some specialized collections, you should think in terms of a general Job model:

// Firestore: /jobs/{jobId}
type JobType =
  | 'TAXI'
  | 'WATER'
  | 'GAS'
  | 'GROCERIES'
  | 'PLACE_BOOKING'
  | 'ACTIVITY_BOOKING'
  | 'REAL_ESTATE_LEAD'
  | 'ERRAND';

type JobStatus =
  | 'pending'
  | 'accepted'
  | 'in_progress'
  | 'rejected'
  | 'completed'
  | 'cancelled'
  | 'expired';

interface Job {
  id: string;
  cityId: string;
  type: JobType;
  userId: string;

  // Spatial context
  origin?: {
    lat: number;
    lng: number;
    placeId?: string;
    areaId?: string;
  };
  destination?: {
    lat: number;
    lng: number;
    placeId?: string;
    areaId?: string;
  };

  placeId?: string;       // for bookings
  activityId?: string;

  status: JobStatus;
  partnerId?: string;     // driver, vendor, agent, developer, venue

  meta?: Record<string, any>; // specialized metadata

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

You can then standardize meta fields:
	‚Ä¢	For taxis: origin/destination details, estimated price/time.
	‚Ä¢	For utilities: address, apartment, preferred delivery window.
	‚Ä¢	For housing: budget, beds, uni/area preferences.

5.2. Taxi-specific (current implementation)

You already have something like taxiBookings:

// Firestore: /taxiBookings/{id}
interface TaxiBooking {
  id: string;
  cityId: string;
  userId: string;
  status: JobStatus;          // or a taxi-specific enum
  pickup: {
    lat: number;
    lng: number;
    placeId?: string;
    description?: string;
  };
  dropoff?: {
    lat: number;
    lng: number;
    placeId?: string;
    description?: string;
  };
  requestedAt: FirebaseTimestamp;
  assignedAt?: FirebaseTimestamp;
  completedAt?: FirebaseTimestamp;

  driverId?: string;          // if you model drivers
  channelMessageId?: string;  // Twilio / WhatsApp mapping
}

Over time, you can unify this with jobs by storing a jobId.

5.3. Housing Leads (Real Estate Jobs)

This is critical for your revenue:

// Firestore: /housingLeads/{leadId} OR as Job.type = REAL_ESTATE_LEAD
interface HousingLead {
  id: string;
  cityId: string;
  userId: string;
  userType: UserType;         // useful ‚Äì student/expat/traveller/local

  intent: 'rent' | 'buy' | 'invest';
  budgetMin?: number;
  budgetMax?: number;
  bedrooms?: number;
  bathrooms?: number;
  furnished?: boolean;
  newBuildOnly?: boolean;

  preferredAreas?: string[];  // areaIds
  nearUniversities?: string[];
  nearPlaces?: string[];

  moveInFrom?: FirebaseTimestamp;
  moveInTo?: FirebaseTimestamp;

  notes?: string;

  // Routing
  assignedPartnerId?: string;     // agent/developer partner
  status: 'new' | 'contacted' | 'viewing_scheduled' | 'offer_made' | 'closed' | 'lost';

  // Outcome
  dealValue?: number;
  commissionValue?: number;
  closedAt?: FirebaseTimestamp;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

In v1, this can be a dedicated collection; later, it can be jobs with type: 'REAL_ESTATE_LEAD'.

‚∏ª

6. Listings & marketplace

For Explore and any listing-based suggestions.

6.1. UnifiedListing / HousingListing

You‚Äôve already defined a UnifiedItem / listing abstraction. For housing in North Cyprus:

// Firestore: /listings/{listingId}
type ListingCategory = 'housing' | 'car' | 'service' | 'experience';

interface Listing {
  id: string;
  cityId: string;
  category: ListingCategory;       // v1: primarily 'housing'

  title: string;
  description?: string;
  images: string[];

  price: number;
  currency: string;
  billingPeriod?: 'night' | 'month' | 'year' | 'once';

  // Housing specifics (for category = 'housing')
  propertyType?: 'apartment' | 'studio' | 'villa' | 'room';
  bedrooms?: number;
  bathrooms?: number;
  furnished?: boolean;
  sizeSqm?: number;
  floor?: number;

  areaId?: string;
  placeId?: string;                // housing project
  coordinates?: { lat: number; lng: number };

  // Contacts / source
  sourceType: 'agent' | 'developer' | 'owner' | 'aggregated';
  partnerId?: string;              // /partners entry
  externalUrl?: string;

  // Status
  isActive: boolean;
  isFeatured?: boolean;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

Typesense index would be built on top of this (downstream).

6.2. Viewings / ListingsBookings

When someone wants to see a specific listing:

// Firestore: /viewings/{viewingId}
interface Viewing {
  id: string;
  listingId: string;
  userId: string;
  cityId: string;
  partnerId?: string;        // agent/developer
  requestedAt: FirebaseTimestamp;
  scheduledFor?: FirebaseTimestamp;
  status: 'requested' | 'scheduled' | 'completed' | 'cancelled';
  notes?: string;
}

This can be created via chat or Explore when user clicks ‚ÄúSchedule viewing‚Äù.

‚∏ª

7. Partners / suppliers

You need a unified way to model taxi owners, drivers, agents, developers, vendors, venues.

7.1. Partner

// Firestore: /partners/{partnerId}
type PartnerType =
  | 'taxi_company'
  | 'driver'
  | 'water_vendor'
  | 'gas_vendor'
  | 'grocer'
  | 'venue'            // bar, restaurant, club
  | 'tour_operator'
  | 'developer'
  | 'real_estate_agent'
  | 'landlord';

interface Partner {
  id: string;
  cityId: string;
  type: PartnerType;

  name: string;
  contactName?: string;
  phone?: string;
  whatsapp?: string;
  email?: string;
  website?: string;

  placeId?: string;            // if they operate out of a Place

  // Operational config
  isActive: boolean;
  supportsJobTypes: JobType[];

  // Economics
  commissionModel?: {
    type: 'percentage' | 'flat';
    percentage?: number;       // e.g. 10 for 10%
    flatAmount?: number;
    currency?: string;
  };

  notes?: string;

  createdAt: FirebaseTimestamp;
  updatedAt: FirebaseTimestamp;
}

7.2. Partner assignments to jobs

In Job/HousingLead/Viewing you store partnerId. That ties the OS to revenue.

‚∏ª

8. Intelligence & events

This is your Demand Intelligence layer.

8.1. UserIntelligence

From onMessageAnalyze and other signals:

// Firestore: /userIntelligence/{userId}
interface UserIntelligence {
  userId: string;
  cityId: string;

  // Derived preferences/interests
  inferredInterests: string[];     // 'nightlife', 'beach', 'quiet areas'
  housingPreferences?: {
    budgetRange?: [number, number];
    propertyTypes?: string[];
    preferredAreas?: string[];
  };

  // Behaviour summary
  lastActiveAt: FirebaseTimestamp;
  messageCount: number;
  taxiRequestCount: number;
  housingLeadCount: number;
  placesVisitedCount: number;

  // Segments for personalization:
  segments: string[];              // 'student_party', 'expat_remote', etc.

  updatedAt: FirebaseTimestamp;
}

This can be synced to Typesense / other search engines.

8.2. Events / telemetry

Canonical event stream:

// Firestore: /events/{eventId}
type EventType =
  | 'USER_SIGNED_UP'
  | 'CHAT_MESSAGE'
  | 'JOB_CREATED'
  | 'JOB_STATUS_CHANGED'
  | 'MAP_PLACE_TAP'
  | 'PLACE_CHECK_IN'
  | 'LISTING_VIEWED'
  | 'VIEWING_REQUESTED';

interface Event {
  id: string;
  cityId: string;
  userId?: string;
  type: EventType;

  objectType?: 'job' | 'place' | 'listing' | 'post';
  objectId?: string;

  metadata?: Record<string, any>;
  createdAt: FirebaseTimestamp;
}

Later, you can stream this into BigQuery or some other warehouse.

‚∏ª

9. System & notifications

9.1. Notification

To centralize what should appear in-app:

// Firestore: /notifications/{notificationId}
type NotificationType =
  | 'JOB_STATUS'
  | 'HOUSING_UPDATE'
  | 'CHAT_SYSTEM'
  | 'PROMO';

interface Notification {
  id: string;
  userId: string;
  type: NotificationType;

  title: string;
  body: string;
  data?: Record<string, any>;  // e.g. jobId

  read: boolean;
  createdAt: FirebaseTimestamp;
}

You can drive:
	‚Ä¢	in-app notification center,
	‚Ä¢	optionally, FCM push later.

‚∏ª

10. How userType fits across everything

You asked specifically about userType (student, expat, traveller/visitor, local) and city/university.

Key connections:
	‚Ä¢	UserProfile.userType
	‚Ä¢	UserProfile.currentCityId, and for students universityId/campusName.
	‚Ä¢	HousingLead.userType ‚Äì use to tailor housing recommendations (students vs expats vs investors).
	‚Ä¢	Tribe.type ‚Äì student vs expat groups etc.
	‚Ä¢	UserIntelligence.segments ‚Äì layered on top of userType (e.g. student_party, expat_quiet_worker).

Behaviourally:
	‚Ä¢	Students:
	‚Ä¢	Strong link to /universities, /areas around campuses.
	‚Ä¢	You show them tribes and places tagged students.
	‚Ä¢	Their housing leads have dorm/adjoining-area preferences.
	‚Ä¢	Expats:
	‚Ä¢	Focus on quiet areas, co-working, long-stay rentals.
	‚Ä¢	Higher budgets; more interest in investment listings.
	‚Ä¢	Travellers/visitors:
	‚Ä¢	Focus on activities, short-term stays, tours.
	‚Ä¢	Time-bounded stayStartDate/stayEndDate.
	‚Ä¢	Locals:
	‚Ä¢	Might use app primarily for services and events, but are important for supply (drivers, agents, etc.).

All of that is captured by the combination of:
	‚Ä¢	UserProfile,
	‚Ä¢	UserIntelligence,
	‚Ä¢	and city/area relationships.

‚∏ª



The important thing is: every new feature you build should fit into one of these domains and reuse these models, so you don‚Äôt drift away from the Micro-City OS architecture.